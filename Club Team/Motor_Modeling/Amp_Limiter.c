#pragma config(I2C_Usage, I2C1, i2cSensors)
#pragma config(Sensor, I2C_1,  ,               sensorQuadEncoderOnI2CPort,    , AutoAssign )
#pragma config(Sensor, I2C_2,  ,               sensorQuadEncoderOnI2CPort,    , AutoAssign )
#pragma config(Motor,  port2,           TEST,          tmotorVex393_MC29, openLoop, encoderPort, I2C_1)
#pragma config(Motor,  port3,           TEST2,         tmotorVex393_MC29, openLoop, reversed, encoderPort, I2C_2)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#include "Amp_Limiter_Func.c"

SmartMotor motorA;
SmartMotor motorB;
task one;
task two;


task main()
{

init_SmartMotor(motorA, TEST2);
init_SmartMotor(motorB, TEST);

motorA.targetAmp = 3.5;
motorB.targetAmp = 3.5;


startTask(one);
startTask(two);

motor[TEST] = 0;
motor[TEST2] = 0;

while(1){

int forward_channel = abs(vexRT[Ch3]) <= 15 ? 0 : vexRT[Ch3];
int turn_channel = abs(vexRT[Ch1]) <= 15 ? 0 : vexRT[Ch1];

motor[TEST] = (forward_channel*1.5 + turn_channel*0.4)/2 - motorB.deltaEffort;
motor[TEST2] = (forward_channel*1.5 - turn_channel*0.4)/2 - motorA.deltaEffort;


clearDebugStream();
writeDebugStream("Effort:%d\n",motorA.effort);
writeDebugStream("Effort Delta:%d\n",motorA.deltaEffort);
writeDebugStream("Effort Volts:%f\n",motorA.effortVolts);
writeDebugStream("Start Volts:%f\n",motorA.startVolts);
writeDebugStream("Check1:%d\n",motor[motorA.smotor]);
writeDebugStream("BackEMF:%f\n",motorA.backEMF);
writeDebugStream("Amp:%f\n",motorA.amps);
writeDebugStream("Direction:%d\n",motorA.direction);
writeDebugStream("RPM:%d\n",getMotorVelocity(motorA.smotor));

wait1Msec(10);

}

}

task one{
start_SmartMotor(motorA);
}

task two{
start_SmartMotor(motorB);
}
